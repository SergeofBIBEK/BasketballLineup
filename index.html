<html>
    <head>
        <link rel='shortcut icon' href='favicon.ico' type='image/x-icon' />
        <!--Begin Firebase Code-->
        <script src="https://www.gstatic.com/firebasejs/3.5.1/firebase.js"></script>
        <script src="fbdbref.js"></script>
        <!--End Firebase Code-->
        <!--Pull in jquery-->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <title>Basketball Lineup</title>
        <link rel="stylesheet" href="main.css">
    </head>
<body>

    <div class="theContainer" id="theContainer" style="display: none">
        <input type="button" id="backToCoachButton" value="Back to Lineup List" onclick="backtoCoach()" style="height:30px;float:;eft;background-color:black;color:white;border-radius:100%;"/>

        <h1>Basketball Lineup</h1>

        <input type="button" id="saveLineupButton" value="Copy Lineup" onclick="copyLineup()" style="height:30px;float:right;background-color:blue;color:white;border-radius:100%;"/>
        <input type="button" id="saveLineupButton" value="Save Lineup" onclick="saveLineup()" style="height:30px;float:right;background-color:green;color:white;border-radius:100%;"/>

        <h2>Assignments</h2>
        <div class="firstTable" id="firstTable">
            <div id="titleRow" class="titleRow">
                <div class="titleCell"><p>Player</p></div>
                <div class="titleCell" hide1st="false"><p>20-16 Minutes</p></div>
                <div class="titleCell"><p>16-12 Minutes</p></div>
                <div class="titleCell"><p>12-8 Minutes</p></div>
                <div class="titleCell"><p>8-4 Minutes</p></div>
                <div class="titleCell"><p>4-0 Minutes</p></div>
                <div class="titleCell" halftime="true"><p>HALF<br>TIME</p></div>
                <div class="titleCell" hide1st="false"><p>20-16 Minutes</p></div>
                <div class="titleCell"><p>16-12 Minutes</p></div>
                <div class="titleCell"><p>12-8 Minutes</p></div>
                <div class="titleCell"><p>8-4 Minutes</p></div>
                <div class="titleCell"><p>4-0 Minutes</p></div>
                <div class="titleCell"><p>Totals</p></div>
            </div>
        </div>
        <input type="button" id="newPlayerButton" value="+" onclick="addNewPlayer()" style="background-color:green;border-radius:100%;" />
        <label for="newPlayerButton">Add a Player</label>
        <input type="button" id="deletePlayerButton" value="-" onclick="deletePlayer()" style="background-color:red;border-radius:100%;" />
        <label for="deletePlayerButton">Remove a Player</label>
        <input type="button" id="reorderPlayerButton" value="^" onclick="reorderPlayer()" style="background-color:blue;border-radius:100%;" />
        <label for="reorderPlayerButton">Reorder Players</label>
        <div id="newPlayerDiv" style="display: none">

            <label for="newPlayerName">New Player Name</label>
            <input type="text" id="newPlayerName" />
            <input type="button" id="newPlayerSubmit" value="Save" onclick="saveNewPlayer()" />

        </div>
        <div id="removePlayerDiv" style="display: none">

            <label for="removePlayerName">Player to Remove</label>
            <input type="text" id="removePlayerName" />
            <input type="button" id="removePlayerSubmit" value="Remove" onclick="removePlayer()" />

        </div>

        <br />
        <h2>Lineup by Play Period</h2>
        <div class="playingTable" id="playingTable">
            <div id="titleRow" class="titleRow">
                <div class="titleCell" hide1st="false"><p>20-16 Minutes</p></div>
                <div class="titleCell"><p>16-12 Minutes</p></div>
                <div class="titleCell"><p>12-8 Minutes</p></div>
                <div class="titleCell"><p>8-4 Minutes</p></div>
                <div class="titleCell"><p>4-0 Minutes</p></div>
                <div class="titleCell" halftime="true"><p>HALF<br>TIME</p></div>
                <div class="titleCell" hide1st="false"><p>20-16 Minutes</p></div>
                <div class="titleCell"><p>16-12 Minutes</p></div>
                <div class="titleCell"><p>12-8 Minutes</p></div>
                <div class="titleCell"><p>8-4 Minutes</p></div>
                <div class="titleCell"><p>4-0 Minutes</p></div>
            </div>
            <div id="playingRow1" class="playingRow1">
                <div id="playingCell1x1" class="playingCell" hide1st="false"></div>
                <div id="playingCell1x2" class="playingCell"></div>
                <div id="playingCell1x3" class="playingCell"></div>
                <div id="playingCell1x4" class="playingCell"></div>
                <div id="playingCell1x5" class="playingCell"></div>
                <div id="playingCell1x6" class="playingCell" halftime="true"><p>|</p></div>
                <div id="playingCell1x7" class="playingCell" hide1st="false"></div>
                <div id="playingCell1x8" class="playingCell"></div>
                <div id="playingCell1x9" class="playingCell"></div>
                <div id="playingCell1x10" class="playingCell"></div>
                <div id="playingCell1x11" class="playingCell"></div>
            </div>
            <div id="playingRow2" class="playingRow2">
                <div id="playingCell2x1" class="playingCell" hide1st="false"></div>
                <div id="playingCell2x2" class="playingCell"></div>
                <div id="playingCell2x3" class="playingCell"></div>
                <div id="playingCell2x4" class="playingCell"></div>
                <div id="playingCell2x5" class="playingCell"></div>
                <div id="playingCell2x6" class="playingCell" halftime="true"><p>|</p></div>
                <div id="playingCell2x7" class="playingCell" hide1st="false"></div>
                <div id="playingCell2x8" class="playingCell"></div>
                <div id="playingCell2x9" class="playingCell"></div>
                <div id="playingCell2x10" class="playingCell"></div>
                <div id="playingCell2x11" class="playingCell"></div>
            </div>
            <div id="playingRow3" class="playingRow3">
                <div id="playingCell3x1" class="playingCell" hide1st="false"></div>
                <div id="playingCell3x2" class="playingCell"></div>
                <div id="playingCell3x3" class="playingCell"></div>
                <div id="playingCell3x4" class="playingCell"></div>
                <div id="playingCell3x5" class="playingCell"></div>
                <div id="playingCell3x6" class="playingCell" halftime="true"><p>|</p></div>
                <div id="playingCell3x7" class="playingCell" hide1st="false"></div>
                <div id="playingCell3x8" class="playingCell"></div>
                <div id="playingCell3x9" class="playingCell"></div>
                <div id="playingCell3x10" class="playingCell"></div>
                <div id="playingCell3x11" class="playingCell"></div>
            </div>
            <div id="playingRow4" class="playingRow4">
                <div id="playingCell4x1" class="playingCell" hide1st="false"></div>
                <div id="playingCell4x2" class="playingCell"></div>
                <div id="playingCell4x3" class="playingCell"></div>
                <div id="playingCell4x4" class="playingCell"></div>
                <div id="playingCell4x5" class="playingCell"></div>
                <div id="playingCell4x6" class="playingCell" halftime="true"><p>|</p></div>
                <div id="playingCell4x7" class="playingCell" hide1st="false"></div>
                <div id="playingCell4x8" class="playingCell"></div>
                <div id="playingCell4x9" class="playingCell"></div>
                <div id="playingCell4x10" class="playingCell"></div>
                <div id="playingCell4x11" class="playingCell"></div>
            </div>
            <div id="playingRow5" class="playingRow5">
                <div id="playingCell5x1" class="playingCell" hide1st="false"></div>
                <div id="playingCell5x2" class="playingCell"></div>
                <div id="playingCell5x3" class="playingCell"></div>
                <div id="playingCell5x4" class="playingCell"></div>
                <div id="playingCell5x5" class="playingCell"></div>
                <div id="playingCell5x6" class="playingCell" halftime="true"><p>|</p></div>
                <div id="playingCell5x7" class="playingCell" hide1st="false"></div>
                <div id="playingCell5x8" class="playingCell"></div>
                <div id="playingCell5x9" class="playingCell"></div>
                <div id="playingCell5x10" class="playingCell"></div>
                <div id="playingCell5x11" class="playingCell"></div>
            </div>

        </div>
        <br />
        <h2>Bench by Play Period</h2>
        <div class="benchTable" id="benchTable">
            <div id="titleRow" class="titleRow">
                <div class="titleCell" hide1st="false"><p>20-16 Minutes</p></div>
                <div class="titleCell"><p>16-12 Minutes</p></div>
                <div class="titleCell"><p>12-8 Minutes</p></div>
                <div class="titleCell"><p>8-4 Minutes</p></div>
                <div class="titleCell"><p>4-0 Minutes</p></div>
                <div class="titleCell" halftime="true"><p>HALF<br>TIME</p></div>
                <div class="titleCell" hide1st="false"><p>20-16 Minutes</p></div>
                <div class="titleCell"><p>16-12 Minutes</p></div>
                <div class="titleCell"><p>12-8 Minutes</p></div>
                <div class="titleCell"><p>8-4 Minutes</p></div>
                <div class="titleCell"><p>4-0 Minutes</p></div>
            </div>
            <div id="benchRow" class="benchRow">
                <div class="benchCell" id="benchCell1" hide1st="false"></div>
                <div class="benchCell" id="benchCell2"></div>
                <div class="benchCell" id="benchCell3"></div>
                <div class="benchCell" id="benchCell4"></div>
                <div class="benchCell" id="benchCell5"></div>
                <div class="benchCell" id="benchCell6" halftime="true"><p>|</p></div>
                <div class="benchCell" id="benchCell7" hide1st="false"></div>
                <div class="benchCell" id="benchCell8"></div>
                <div class="benchCell" id="benchCell9"></div>
                <div class="benchCell" id="benchCell10"></div>
                <div class="benchCell" id="benchCell11"></div>
            </div>
        </div>
    </div>

    <div id="EnterCoachID" style="display: none">
        <h1>Enter Your Secret Coach ID</h1>
        <h3>Optional: Enter your LineupID</h3>
        <form method="get">
        <label for="coachInput" id="coachInputLabel">CoachID</label>
        <input type="text" name="CoachID" id="coachInput" />

        <label for="lineupInput" id="lineupInputLabel">LineupID</label>
        <input type="text" name="LineupID" id="lineupInput" />

        <input type="submit" id="coachSubmit" />
        </form>

        <h4>New? Set up a new CoachID</h4>
        <label for="newCoachID">New CoachID</label>
        <input type="text" id="newCoachID" />
        <input type="button" value="Submit" onclick="setUpNewCoach()">
        <p style="color:red; font-size:small;">Note: Make CoachID hard to guess and do not share it with other coaches.</p>

    </div>

    <div id ="ChooseLineup" style="display: none">
        <h1>Choose a Lineup:</h1>
        <select id="lineupSelector"></select>
        <input type="button" value="Submit" onclick="navToLineup()" />
        <input type="button" value="Delete" onclick="deleteLineup()" style="background-color:red; border-radius:100%;" />

        <h3>New Lineup:</h3>
        <label for="newLineupInput">New Lineup Name/ID</label>
        <input type="text" id="newLineupInput" />
        <label for="newLineupInput2">Number of play periods each half</label>
        <input type="text" id="newLineupInput2" />
        <input type="button" value="Submit" onclick="setUpNewLineup()">
    </div>

    <div id ="createLineup" style="display: none">
    <h1>Create a new lineup</h1>

        <label for="newLineupName">Name/ID for new Lineup:</label>
        <input type="text" id="newLineupName" />

        <label for="playPeriodsInput">Number of play periods each half: </label>
        <input type="text" id="playPeriodsInput" />
        <input type="button" value="Submit" onclick="saveNewLineup()" />
    </div>

    <script>
        //firebase vars
        var database = firebase.database();
        var CoachID = "";
        var currentLineup = "";
        var haveCoach = false;
        var haveLineup = false;
        var dataJSON;
        var getDataComplete = false;

        //local vars
        var benchArrays = [["none"]];
        var playingArrays = [["none"],[],[],[],[],[],["none"],[],[],[],[],[]];

        //Completion Variables
        var rowsDone = false;
        var cellsDone = false;
        var totalRowDone = false;
        var benchDone = false;

        window.onload = init();

        function init()
        {
            checkQueryString();

            if (!haveCoach)
                {
                    document.getElementById("EnterCoachID").style.display = "block";

                    getFirebaseData();
                }
            if (haveCoach && !haveLineup)
                {
                    document.getElementById("ChooseLineup").style.display = "block";

                    //Get Firebase list of Lineups
                    getFirebaseData();
                    setLineupList();

                }
            if (haveCoach && haveLineup)
                {
                    document.getElementById("theContainer").style.display = "block";
                    //Get full Firebase data
                    getFirebaseData();

                    createPlayerRows();
                    createPlayerCells();
                    fillPlayerData();
                    createTotalRow();
                    fillTotals();
                    setUpBench();
                    setNumPeriods();
                }
        }

        function checkQueryString()
        {
            if (window.location.search != "")
                {
                    var tempVars = window.location.search.substring(1).split("&");
                    var tempArray = [];

                    for (var i = 0; i < tempVars.length; i++)
                        {
                            tempArray.push(tempVars[i].split("=")[0]);
                            tempArray.push(tempVars[i].split("=")[1]);
                        }

                    if (tempArray.indexOf("CoachID") != -1 && tempArray[eval(tempArray.indexOf("CoachID") + 1)] != "")
                        {
                            CoachID = unescape(tempArray[eval(tempArray.indexOf("CoachID") + 1)]);
                            haveCoach = true;
                        }
                    if (tempArray.indexOf("LineupID") != -1 && tempArray[eval(tempArray.indexOf("LineupID") + 1)] != "")
                        {
                            currentLineup = unescape(tempArray[eval(tempArray.indexOf("LineupID") + 1)]);
                            haveLineup = true;
                        }
                }
        }

        function getFirebaseData()
        {
            if (!haveCoach)
                {
                    $.getJSON(config.databaseURL + "/" + ".json", function(e) {
                    dataJSON = e;
                    getDataComplete = true;
                    });
                }
            if (haveCoach && !haveLineup)
                {
                    $.getJSON(config.databaseURL + "/" + CoachID + ".json", function(e) {
                    dataJSON = e;
                    getDataComplete = true;
                    });
                }
            if (haveCoach && haveLineup)
                {
                    $.getJSON(config.databaseURL + "/" + CoachID + "/" + currentLineup + ".json", function(e) {
                    dataJSON = e;
                    getDataComplete = true;
                    });
                }
        }

        function createPlayerRows()
        {
            if (getDataComplete)
                {
                    var count = 0;
                    for (var player in dataJSON)
                        {
                            if (player != "playPeriods")
                                {
                                    //Create a row for each player.
                                    var newRow = document.createElement("div");
                                    newRow.id = "player" + count + "Row";
                                    newRow.className = "playerRow";
                                    document.getElementById("firstTable").appendChild(newRow);
                                    count++;
                                }
                        }
                    rowsDone = true;
                }
            else
                {
                    setTimeout(createPlayerRows, 100);
                }
        }

        function createPlayerCells()
        {
            if (rowsDone)
                {
                    var rowArray = document.getElementsByClassName("playerRow");

                    for (var i = 0; i < rowArray.length; i++)
                        {
                            for (var j = 0; j < 13; j++)
                                {
                                    var newCell = document.createElement("div");
                                    newCell.id = "player" + i + "Cell" + j;
                                    newCell.className = "playerCell";
                                    if (j == 6)
                                        {
                                            newCell.setAttribute("halftime", "true");
                                        }
                                    if (j == 1 || j == 7)
                                        {
                                            newCell.setAttribute("hide1st", "false");
                                        }
                                    document.getElementById("player" + i + "Row").appendChild(newCell);
                                }
                        }
                    cellsDone = true;
                }
            else
                {
                    setTimeout(createPlayerCells, 100);
                }
        }

        function fillPlayerData()
        {
            if (cellsDone && getDataComplete)
                {
                    for (var player in dataJSON)
                        {
                            if (player != "playPeriods")
                                {
                                    document.getElementById("player" + dataJSON[player].Skill + "Cell0").innerHTML = "<p>" + player + "</p>";

                                    for (var j = 1; j < 6; j++)
                                        {
                                            var newCheckbox = document.createElement("input");
                                            newCheckbox.type = "checkbox";
                                            newCheckbox.id = "player" + dataJSON[player].Skill + "Cell" + j + "Checkbox";
                                            newCheckbox.className = "playingCheckbox";
                                            newCheckbox.setAttribute("onclick","checkboxHandler(this)");
                                            if (dataJSON[player].Checkboxes.split(",")[j] == 1)
                                                {
                                                    newCheckbox.setAttribute("checked", "checked");
                                                }

                                            document.getElementById("player" + dataJSON[player].Skill + "Cell" + j).appendChild(newCheckbox);
                                        }

                                    document.getElementById("player" + dataJSON[player].Skill + "Cell6").innerHTML = "<p>|</p>";

                                    for (var j = 7; j < 12; j++)
                                        {
                                            var newCheckbox = document.createElement("input");
                                            newCheckbox.type = "checkbox";
                                            newCheckbox.id = "player" + dataJSON[player].Skill + "Cell" + j + "Checkbox";
                                            newCheckbox.className = "playingCheckbox";
                                            newCheckbox.setAttribute("onclick","checkboxHandler(this)");
                                            if (dataJSON[player].Checkboxes.split(",")[j] == 1)
                                                {
                                                    newCheckbox.setAttribute("checked", "checked");
                                                }
                                            document.getElementById("player" + dataJSON[player].Skill + "Cell" + j).appendChild(newCheckbox);
                                        }
                                }
                        }
                }
            else
                {
                    setTimeout(fillPlayerData, 100);
                }
        }

        function createTotalRow()
        {
            if (cellsDone && getDataComplete)
                {
                    var newRow = document.createElement("div");
                    newRow.id = "totalRow";
                    newRow.className = "totalRow";
                    document.getElementById("firstTable").appendChild(newRow);

                    for (var j = 0; j < 13; j++)
                                {
                                    var newCell = document.createElement("div");
                                    newCell.id = "totalCell" + j;
                                    newCell.className = "totalCell";
                                    if (j == 6)
                                        {
                                            newCell.setAttribute("halftime", "true");
                                            newCell.innerHTML = "<p>|</p>"
                                        }
                                    if (j == 0)
                                        {
                                            newCell.innerHTML = "<p>Totals</p>"
                                        }
                                    if (j == 1 || j == 7)
                                        {
                                            newCell.setAttribute("hide1st", "false");
                                        }
                                    document.getElementById("totalRow").appendChild(newCell);
                                }
                    totalRowDone = true;
                }
            else
                {
                    setTimeout(createTotalRow, 100);
                }
        }

        function fillTotals()
        {
            if (totalRowDone)
                {
                    var count = 0;
                    for (var player in dataJSON)
                        {
                            if (player != "playPeriods")
                                {
                                    document.getElementById("player" + count + "Cell12").innerHTML = 0;
                                    count++;
                                }
                        }
                    for (var j = 1; j < 6; j++)
                        {
                            document.getElementById("totalCell" + j).innerHTML = 0;
                        }
                     for (var j = 7; j < 13; j++)
                        {
                            document.getElementById("totalCell" + j).innerHTML = 0;
                        }
                }
            else
                {
                    setTimeout(fillTotals, 100);
                }
        }
        function setUpBench()
        {
            if (getDataComplete)
                {
                    for (var i = 1; i < 12; i++)
                        {
                            if (i == 6)
                                {
                                    benchArrays.push(["none"]);
                                }
                            else
                                {
                                    var newArray = [];
                                    for (var player in dataJSON)
                                        {
                                            if (player != "playPeriods")
                                                {
                                                    newArray.push(dataJSON[player]);
                                                }
                                        }
                                    benchArrays.push(newArray);
                                }
                        }
                    updateBench();
                    benchDone = true;
                }
            else
                {
                    setTimeout(setUpBench, 100);
                }
        }

        function setNumPeriods()
        {
            if (totalRowDone && benchDone)
                {
                    if (dataJSON.playPeriods == 4)
                        {
                            var tempArray = $('[hide1st]');

                            for (var i = 0; i < tempArray.length; i++)
                                {
                                    tempArray[i].setAttribute("hide1st", "true");
                                }
                        }
                    $('.playingCheckbox:checkbox:checked').each(function () {checkboxHandler(this);});
                }
            else
                {
                    setTimeout(setNumPeriods,100);
                }
        }

        function updateBench()
        {
            for (var j = 1; j < 12; j++)
                {
                    if (j != 6)
                        {
                            document.getElementById("benchCell" + j).innerHTML = "";

                            for (var k = 0; k < benchArrays[j].length; k++)
                                {
                                    var newP = document.createElement("p");
                                    newP.innerHTML = benchArrays[j][k].Name;
                                    document.getElementById("benchCell" + j).appendChild(newP);
                                }
                        }
                }
        }

        function checkboxHandler(e)
        {
            var playerNum = e.id.split("Cell")[0].split("player")[1];
            var columnNum = e.id.split("Cell")[1].split("Checkbox")[0];
            var playerName = document.getElementById(e.id.split("Cell")[0] + "Cell0").firstChild.innerHTML;
            var playerTotal = parseInt(document.getElementById("player" + playerNum + "Cell12").innerHTML);
            var columnTotal = parseInt(document.getElementById("totalCell" + columnNum).innerHTML);

            if (e.checked == true)
                {
                    document.getElementById("player" + playerNum + "Cell12").innerHTML = playerTotal + 1;
                    document.getElementById("totalCell" + columnNum).innerHTML = columnTotal + 1;

                    if (parseInt(document.getElementById("totalCell" + columnNum).innerHTML) < 5)
                        {
                            document.getElementById("totalCell" + columnNum).style.backgroundColor = "gray";
                        }
                    if (parseInt(document.getElementById("totalCell" + columnNum).innerHTML) == 5)
                        {
                            document.getElementById("totalCell" + columnNum).style.backgroundColor = "green";
                        }
                    if (parseInt(document.getElementById("totalCell" + columnNum).innerHTML) > 5)
                        {
                            document.getElementById("totalCell" + columnNum).style.backgroundColor = "red";
                        }

                    //addToLineup
                    playingArrays[columnNum].push(dataJSON[playerName]);


                    updateLineup();
                    //removeFromBench
                    for (var i = 0; i < benchArrays[columnNum].length; i++)
                    {
                        if (benchArrays[columnNum][i].Name == playerName)
                        {
                            benchArrays[columnNum].splice(i, 1);
                        }
                    }
                    updateBench();
                }
            if (e.checked == false)
                {
                    document.getElementById("player" + playerNum + "Cell12").innerHTML = playerTotal - 1;
                    document.getElementById("totalCell" + columnNum).innerHTML = columnTotal - 1;

                    if (parseInt(document.getElementById("totalCell" + columnNum).innerHTML) < 5)
                        {
                            document.getElementById("totalCell" + columnNum).style.backgroundColor = "gray";
                        }
                    if (parseInt(document.getElementById("totalCell" + columnNum).innerHTML) == 5)
                        {
                            document.getElementById("totalCell" + columnNum).style.backgroundColor = "green";
                        }
                    if (parseInt(document.getElementById("totalCell" + columnNum).innerHTML) > 5)
                        {
                            document.getElementById("totalCell" + columnNum).style.backgroundColor = "red";
                        }
                    //remove from lineup
                    for (var i = 0; i < playingArrays[columnNum].length; i++)
                    {
                        if (playingArrays[columnNum][i].Name == playerName)
                        {
                            playingArrays[columnNum].splice(i, 1);
                        }
                    }

                    updateLineup();
                    //add to bench
                    benchArrays[columnNum].push(dataJSON[playerName]);
                    updateBench();
                }
            updateTotal();
        }

        function updateTotal()
        {
            var runningTotal = 0;

            for (var player in dataJSON)
                    {
                        if (player != "playPeriods")
                            {
                                runningTotal += parseInt(document.getElementById("player" + dataJSON[player].Skill + "Cell12").innerHTML);
                            }
                    }

            document.getElementById("totalCell12").innerHTML = runningTotal;
        }
        function updateLineup()
        {
            for (var j = 1; j < 12; j++)
                {
                    if (dataJSON.playPeriods == 4)
                        {
                            playingArrays[j].sort(function (a, b) {
                              return a.Skill - b.Skill;
                            });
                        }
                    if (j != 6)
                        {
                            for (var l = 1; l < 6; l++)
                                {
                                    document.getElementById("playingCell" + l + "x" + j).innerHTML = "";
                                }

                            for (var k = 0; k < playingArrays[j].length; k++)
                                {
                                    if (k < 5)
                                        {
                                            document.getElementById("playingCell" + eval(k + 1) + "x" + j).innerHTML = playingArrays[j][k].Name;
                                        }
                                }
                        }
                }
        }

        function setLineupList()
        {
            if (getDataComplete == true)
                {
                    for (var lineup in dataJSON)
                        {
                            var newOption = document.createElement("option");
                            newOption.value = lineup;
                            newOption.innerHTML= lineup;
                            document.getElementById("lineupSelector").appendChild(newOption);
                        }
                }
            else
                {
                    setTimeout(setLineupList, 100);
                }
        }

        function navToLineup()
        {
            document.getElementById("coachInput").value = CoachID;
            document.getElementById("lineupInput").value = document.getElementById("lineupSelector").value;
            document.getElementById("coachSubmit").click();

        }

        function setUpNewCoach()
        {
            var alreadyTaken = false;

            for (var coach in dataJSON)
                {
                    if (coach == document.getElementById("newCoachID").value)
                        {
                            alreadyTaken = true;
                        }
                }

            if (alreadyTaken)
                {
                    alert("Invalid CoachID");
                }
            else
                {
                   document.getElementById("EnterCoachID").style.display = "none";
                    document.getElementById("createLineup").style.display = "block";
                }
        }

        function saveNewLineup()
        {
            var newCoach = unescape(document.getElementById("newCoachID").value);
            var newLineup = unescape(document.getElementById("newLineupName").value);
            var newPlayPeriods = document.getElementById("playPeriodsInput").value;

            if (newLineup != "" && newPlayPeriods != "")
                {
                    firebase.database().ref(newCoach + "/" + newLineup).update({
                        "playPeriods": newPlayPeriods,
                    });

                    window.location.search = "?CoachID=" + newCoach + "&LineupID=" + newLineup;
                }
            else
                {
                    alert("Please Fill In All Fields");
                }
        }

        function setUpNewLineup()
        {
            var newLineup = unescape(document.getElementById("newLineupInput").value);
            var newPlayPeriods = document.getElementById("newLineupInput2").value;

            if (newLineup != "" && newPlayPeriods != "")
                {
                    firebase.database().ref(CoachID + "/" + newLineup).update({
                        "playPeriods": newPlayPeriods,
                    });

                    window.location.search = "?CoachID=" + CoachID + "&LineupID=" + newLineup;
                }
            else
                {
                    alert("Please Fill In All Fields");
                }
        }

        function addNewPlayer()
        {
            document.getElementById("newPlayerDiv").style.display = "block";
        }

        function saveNewPlayer()
        {
            var newCount = 0;
            var alreadyExists = false;
            var newPlayer = document.getElementById("newPlayerName").value;

            for (var player in dataJSON)
                {
                    if (player != "playPeriods")
                        {
                            if (player == newPlayer)
                                {
                                    alreadyExists = true;
                                }
                            newCount++;
                        }
                }

            if (alreadyExists || newPlayer == "playPeriods" || newPlayer == "")
                {
                    alert("Invalid Name, Try Again");
                }
            else
                {
                    firebase.database().ref(CoachID + "/" + currentLineup + "/" + newPlayer).update({
                        "Name": newPlayer,
                        "Skill": newCount,
                        "Checkboxes": "0,0,0,0,0,0,0,0,0,0,0,0,0",
                    });

                    window.location.search = "?CoachID=" + CoachID + "&LineupID=" + currentLineup;
                }
            //save the new player
        }

        function saveLineup()
        {
            for (var player in dataJSON)
                {
                    if (player != "playPeriods")
                        {
                            var tempString = "0";
                            for (var checkbox = 1; checkbox < 12; checkbox++)
                                {
                                    if (checkbox != 6)
                                        {
                                            if (document.getElementById("player" + dataJSON[player].Skill + "Cell" + checkbox + "Checkbox").checked)
                                                {
                                                    tempString += ",1";
                                                }
                                            else
                                                {
                                                    tempString += ",0";
                                                }
                                        }
                                    else
                                        {
                                            tempString += ",0";
                                        }
                                }
                            tempString += ",0";


                            firebase.database().ref(CoachID + "/" + currentLineup + "/" + player).update({
                                "Checkboxes": tempString,
                            });
                        }
                }
        }

        function copyLineup()
        {
            var copyToLineup = prompt("Please enter lineup name/ID to copy to. | Note: This will create a new lineup if there is not one, and it will overwrite existing lineups.");

            if (copyToLineup == "" || copyToLineup == "playPeriods")
                {
                    alert("Invalid Name");

                }
            else
                {
                    firebase.database().ref(CoachID + "/" + copyToLineup).update({
                                "playPeriods": dataJSON.playPeriods,
                            });

                    for (player in dataJSON)
                        {
                            if (player != "playPeriods")
                                {
                                    firebase.database().ref(CoachID + "/" + copyToLineup + "/" + player).update({
                                        "Checkboxes": dataJSON[player].Checkboxes,
                                        "Skill": dataJSON[player].Skill,
                                        "Name": dataJSON[player].Name,
                                    });
                                }
                        }
                    alert("Copied successfully to:" + copyToLineup);
                }
        }

        function backtoCoach()
        {
            window.location.search = "?CoachID=" + CoachID;
        }

        function deleteLineup()
        {
            var lineupToDelete = document.getElementById("lineupSelector").value;
            var decision = confirm("Are you sure you wish to delete " + lineupToDelete + "? This action cannot be undone.");

            if (decision)
                {
                    firebase.database().ref(CoachID + "/" + lineupToDelete).remove();
                }
            backtoCoach();

        }

        function deletePlayer()
        {
            document.getElementById("removePlayerDiv").style.display = "block";
        }

        function removePlayer()
        {
            var playerToDelete = unescape(document.getElementById("removePlayerName").value);
            var decision = confirm("Are you sure you wish to delete " + playerToDelete + "? This action cannot be undone.");

            if (decision && playerToDelete != "playPeriods" && playerToDelete != "")
                {
                    firebase.database().ref(CoachID + "/" + currentLineup + "/" + playerToDelete).remove();
                }

            setTimeout(function(){window.location.search = "?CoachID=" + CoachID + "&LineupID=" + currentLineup},1000);
        }

        function reorderPlayer()
        {

        }
        //Feature Requests
        /*
            1. after the 5 for a period is selected, the three who didn't play are highlighted in the next column, so you know that you have to select them.
            2. if a kid has gone twice in a row, his cell becomes red.
        */
    </script>
</body>
</html>
